{%- comment -%} 

    _blHideDistanRelatives - prevents files output 

{%- endcomment -%}
{%- assign treeRoot = include.root | default '/' -%}
{%- assign treeDepth = include.depth | default 7 -%}
{%- assign _blHideDistantRelatives = include.hideDistantRelatives | default: false -%}

{%- capture tree -%}<<{{treeRoot}}>>{%- endcapture -%}
{%- assign _blRecursion = true -%}
{%- assign _indent = '' -%}

{%- for iteration in (0..treeDepth) -%} 
    {%- if iteration==treeDepth -%}{%- assign _blRecursion = false -%}{%- endif -%}

    {%- assign _tagsCount = 0 -%}

    {%- comment -%} Parse input to find <<dir>> tags {%- endcomment -%}
    {%- assign parts = tree | split: '<<' -%}
    {%- assign tree = parts[0] -%}
    {%- assign last = parts.size | minus: 1 -%}
    {%- for i in (1..last) -%}
        {%- assign parts2 = parts[i] | split: '>>' -%} 
        {%- assign _dir = parts2[0] -%}  {% comment %} value from <<dir>> tag {% endcomment %}
        {%- comment -%} render tree(dir) level here & schedule work for next level {%- endcomment -%}
        {% include folder.liquid %}
        {% capture tree %}{{tree}}{{_folderMd}}{{parts2[1]}}{% endcapture %}
    {%- endfor -%} {% comment %} folders within level iteration end {% endcomment %}
    {%- assign _indent = _indent | append: '  ' -%}
    
    {%- comment -%} <textarea style="width: 100%; height: 200px; font-size: 11px;">{{ tree }}</textarea> {%- endcomment -%}
    {%- if _tagsCount==0 -%}{%- break -%}{%- endif -%}
    
{%- endfor -%}
{%- comment -%} <textarea style="width: 100%; height: 250px; font-size: 11px; background: #EEC;">{{ tree }}</textarea> {%- endcomment -%}
{%- comment -%} <textarea style="width: 100%; height: 250px; font-size: 11px; background: #EEC;">{{ tree | markdownify }}</textarea> {%- endcomment -%}
{{ tree | markdownify }}